I"æ‰<ul id="markdown-toc">
  <li><a href="#openssl" id="markdown-toc-openssl">OpenSSL</a>    <ul>
      <li><a href="#ä»‹ç»" id="markdown-toc-ä»‹ç»">ä»‹ç»</a></li>
      <li><a href="#æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯" id="markdown-toc-æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯">æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</a>        <ul>
          <li><a href="#æ™®é€š" id="markdown-toc-æ™®é€š">æ™®é€š</a></li>
          <li><a href="#è¯¦ç»†" id="markdown-toc-è¯¦ç»†">è¯¦ç»†</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#åˆ¶ä½œè¯ä¹¦" id="markdown-toc-åˆ¶ä½œè¯ä¹¦">åˆ¶ä½œè¯ä¹¦</a>    <ul>
      <li><a href="#ca" id="markdown-toc-ca">CA</a>        <ul>
          <li><a href="#conf-ç›®å½•æ–°å»º-opensslconf-æ–‡ä»¶" id="markdown-toc-conf-ç›®å½•æ–°å»º-opensslconf-æ–‡ä»¶">conf ç›®å½•æ–°å»º openssl.conf æ–‡ä»¶</a></li>
          <li><a href="#ç”Ÿæˆç§é’¥-key-æ–‡ä»¶" id="markdown-toc-ç”Ÿæˆç§é’¥-key-æ–‡ä»¶">ç”Ÿæˆç§é’¥ key æ–‡ä»¶</a></li>
          <li><a href="#ç”Ÿæˆè¯ä¹¦è¯·æ±‚-csr-æ–‡ä»¶" id="markdown-toc-ç”Ÿæˆè¯ä¹¦è¯·æ±‚-csr-æ–‡ä»¶">ç”Ÿæˆè¯ä¹¦è¯·æ±‚ csr æ–‡ä»¶</a></li>
          <li><a href="#ç”Ÿæˆå‡­è¯-crt-æ–‡ä»¶" id="markdown-toc-ç”Ÿæˆå‡­è¯-crt-æ–‡ä»¶">ç”Ÿæˆå‡­è¯ crt æ–‡ä»¶</a></li>
          <li><a href="#ä¸ºæˆ‘ä»¬çš„-key-è®¾ç½®èµ·å§‹åºåˆ—å·å¯ä»¥æ˜¯ä»»æ„å››ä¸ªå­—ç¬¦å’Œåˆ›å»º-ca-é”®åº“" id="markdown-toc-ä¸ºæˆ‘ä»¬çš„-key-è®¾ç½®èµ·å§‹åºåˆ—å·å¯ä»¥æ˜¯ä»»æ„å››ä¸ªå­—ç¬¦å’Œåˆ›å»º-ca-é”®åº“">ä¸ºæˆ‘ä»¬çš„ key è®¾ç½®èµ·å§‹åºåˆ—å·(å¯ä»¥æ˜¯ä»»æ„å››ä¸ªå­—ç¬¦)å’Œåˆ›å»º CA é”®åº“</a></li>
          <li><a href="#ä¸º-ç”¨æˆ·è¯ä¹¦-çš„ç§»é™¤åˆ›å»ºä¸€ä¸ªè¯ä¹¦æ’¤é”€åˆ—è¡¨" id="markdown-toc-ä¸º-ç”¨æˆ·è¯ä¹¦-çš„ç§»é™¤åˆ›å»ºä¸€ä¸ªè¯ä¹¦æ’¤é”€åˆ—è¡¨">ä¸º â€œç”¨æˆ·è¯ä¹¦â€ çš„ç§»é™¤åˆ›å»ºä¸€ä¸ªè¯ä¹¦æ’¤é”€åˆ—è¡¨</a></li>
        </ul>
      </li>
      <li><a href="#æœåŠ¡å™¨è¯ä¹¦çš„ç”Ÿæˆ" id="markdown-toc-æœåŠ¡å™¨è¯ä¹¦çš„ç”Ÿæˆ">æœåŠ¡å™¨è¯ä¹¦çš„ç”Ÿæˆ</a>        <ul>
          <li><a href="#åˆ›å»ºä¸€ä¸ª-key" id="markdown-toc-åˆ›å»ºä¸€ä¸ª-key">åˆ›å»ºä¸€ä¸ª key</a></li>
          <li><a href="#ä¸ºæˆ‘ä»¬çš„-key-åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚-csr-æ–‡ä»¶" id="markdown-toc-ä¸ºæˆ‘ä»¬çš„-key-åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚-csr-æ–‡ä»¶">ä¸ºæˆ‘ä»¬çš„ key åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚ csr æ–‡ä»¶</a></li>
          <li><a href="#ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„-ca-key-ä¸ºåˆšæ‰çš„-key-ç­¾å" id="markdown-toc-ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„-ca-key-ä¸ºåˆšæ‰çš„-key-ç­¾å">ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„ CA key ä¸ºåˆšæ‰çš„ key ç­¾å</a></li>
        </ul>
      </li>
      <li><a href="#å®¢æˆ·ç«¯è¯ä¹¦çš„ç”Ÿæˆ" id="markdown-toc-å®¢æˆ·ç«¯è¯ä¹¦çš„ç”Ÿæˆ">å®¢æˆ·ç«¯è¯ä¹¦çš„ç”Ÿæˆ</a>        <ul>
          <li><a href="#åˆ›å»ºå­˜æ”¾-key-çš„ç›®å½•-users" id="markdown-toc-åˆ›å»ºå­˜æ”¾-key-çš„ç›®å½•-users">åˆ›å»ºå­˜æ”¾ key çš„ç›®å½• users</a></li>
          <li><a href="#ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ª-key" id="markdown-toc-ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ª-key">ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ª key</a></li>
          <li><a href="#ä¸º-key-åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚-csr-æ–‡ä»¶" id="markdown-toc-ä¸º-key-åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚-csr-æ–‡ä»¶">ä¸º key åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚ csr æ–‡ä»¶</a></li>
          <li><a href="#ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„-ca-key-ä¸ºåˆšæ‰çš„-key-ç­¾å-1" id="markdown-toc-ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„-ca-key-ä¸ºåˆšæ‰çš„-key-ç­¾å-1">ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„ CA key ä¸ºåˆšæ‰çš„ key ç­¾å</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#nginxé…ç½®" id="markdown-toc-nginxé…ç½®">Nginxé…ç½®</a></li>
  <li><a href="#è§£é‡Š" id="markdown-toc-è§£é‡Š">è§£é‡Š</a>    <ul>
      <li><a href="#ssl" id="markdown-toc-ssl">SSL</a></li>
      <li><a href="#x509" id="markdown-toc-x509">X.509</a></li>
      <li><a href="#pem" id="markdown-toc-pem">PEM</a></li>
      <li><a href="#der" id="markdown-toc-der">DER</a></li>
      <li><a href="#crt" id="markdown-toc-crt">CRT</a></li>
      <li><a href="#cer" id="markdown-toc-cer">CER</a></li>
      <li><a href="#key" id="markdown-toc-key">KEY</a></li>
      <li><a href="#csr" id="markdown-toc-csr">CSR</a></li>
      <li><a href="#pfxp12" id="markdown-toc-pfxp12">PFX/P12</a></li>
      <li><a href="#keytool" id="markdown-toc-keytool">Keytool</a></li>
      <li><a href="#keystore" id="markdown-toc-keystore">KeyStore</a></li>
      <li><a href="#truststore" id="markdown-toc-truststore">TrustStore</a></li>
      <li><a href="#jks" id="markdown-toc-jks">JKS</a></li>
      <li><a href="#è¯ä¹¦ç¼–ç çš„è½¬æ¢" id="markdown-toc-è¯ä¹¦ç¼–ç çš„è½¬æ¢">è¯ä¹¦ç¼–ç çš„è½¬æ¢</a></li>
      <li><a href="#è¯ä¹¦æ ¼å¼ä»‹ç»" id="markdown-toc-è¯ä¹¦æ ¼å¼ä»‹ç»">è¯ä¹¦æ ¼å¼ä»‹ç»</a></li>
    </ul>
  </li>
  <li><a href="#å‚è€ƒ" id="markdown-toc-å‚è€ƒ">å‚è€ƒ</a></li>
</ul>
<hr />

<h1 id="openssl">OpenSSL</h1>

<h2 id="ä»‹ç»">ä»‹ç»</h2>

<p><a href="https://baike.baidu.com/item/openssl/5454803?fr=aladdin">OpenSSL</a>æ˜¯ä¸€ä¸ªå®‰å…¨<a href="https://baike.baidu.com/item/%E5%A5%97%E6%8E%A5%E5%AD%97">å¥—æ¥å­—</a>å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„<a href="https://baike.baidu.com/item/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95">å¯†ç ç®—æ³•</a>ã€å¸¸ç”¨çš„<a href="https://baike.baidu.com/item/%E5%AF%86%E9%92%A5">å¯†é’¥</a>å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠ<a href="https://baike.baidu.com/item/SSL">SSL</a>åè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚</p>

<h2 id="æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯">æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</h2>

<h3 id="æ™®é€š">æ™®é€š</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl version
</code></pre></div></div>

<p>è¾“å‡º</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>OpenSSL 1.0.2g  1 Mar 2016
</code></pre></div></div>

<h3 id="è¯¦ç»†">è¯¦ç»†</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl version <span class="nt">-a</span>
</code></pre></div></div>

<p>è¾“å‡º</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>OpenSSL 1.0.2g  1 Mar 2016
built on: reproducible build, <span class="nb">date </span>unspecified
platform: linux-x86_64
options:  bn<span class="o">(</span>64,64<span class="o">)</span> rc4<span class="o">(</span>16x,int<span class="o">)</span> des<span class="o">(</span>idx,cisc,16,int<span class="o">)</span> idea<span class="o">(</span>int<span class="o">)</span> blowfish<span class="o">(</span>idx<span class="o">)</span>
compiler: gcc <span class="nt">-I</span><span class="nb">.</span> <span class="nt">-I</span>.. <span class="nt">-I</span>../include  <span class="nt">-fPIC</span> <span class="nt">-DOPENSSL_PIC</span> <span class="nt">-DZLIB_SHARED</span> <span class="nt">-DZLIB</span> <span class="nt">-DOPENSSL_THREADS</span> <span class="nt">-D_REENTRANT</span> <span class="nt">-DDSO_DLFCN</span> <span class="nt">-DHAVE_DLFCN_H</span> <span class="nt">-Wa</span>,--noexecstack <span class="nt">-m64</span> <span class="nt">-DL_ENDIAN</span> <span class="nt">-O3</span> <span class="nt">-Wall</span> <span class="nt">-DOPENSSL_IA32_SSE2</span> <span class="nt">-DOPENSSL_BN_ASM_MONT</span> <span class="nt">-DOPENSSL_BN_ASM_MONT5</span> <span class="nt">-DOPENSSL_BN_ASM_GF2m</span> <span class="nt">-DSHA1_ASM</span> <span class="nt">-DSHA256_ASM</span> <span class="nt">-DSHA512_ASM</span> <span class="nt">-DMD5_ASM</span> <span class="nt">-DAES_ASM</span> <span class="nt">-DVPAES_ASM</span> <span class="nt">-DBSAES_ASM</span> <span class="nt">-DWHIRLPOOL_ASM</span> <span class="nt">-DGHASH_ASM</span> <span class="nt">-DECP_NISTZ256_ASM</span>
OPENSSLDIR: <span class="s2">"/usr/local/ssl"</span>
</code></pre></div></div>

<h1 id="åˆ¶ä½œè¯ä¹¦">åˆ¶ä½œè¯ä¹¦</h1>

<h2 id="ca">CA</h2>

<p>åˆ›å»ºä¸€ä¸ªæ–°çš„ CA æ ¹è¯ä¹¦ï¼Œåœ¨ nginx å®‰è£…ç›®å½•ä¸‹æ–°å»º ca æ–‡ä»¶å¤¹ï¼Œè¿›å…¥ caï¼Œåˆ›å»ºå‡ ä¸ªå­æ–‡ä»¶å¤¹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>ca <span class="o">&amp;&amp;</span> <span class="nb">cd </span>ca  
<span class="nb">mkdir </span>newcerts private conf server

<span class="c"># newcerts å­ç›®å½•å°†ç”¨äºå­˜æ”¾ CA ç­¾ç½²è¿‡çš„æ•°å­—è¯ä¹¦(è¯ä¹¦å¤‡ä»½ç›®å½•)ï¼›private ç”¨äºå­˜æ”¾ CA çš„ç§é’¥ï¼›conf ç›®å½•ç”¨äºå­˜æ”¾ä¸€äº›ç®€åŒ–å‚æ•°ç”¨çš„é…ç½®æ–‡ä»¶ï¼›server å­˜æ”¾æœåŠ¡å™¨è¯ä¹¦æ–‡ä»¶ã€‚</span>
</code></pre></div></div>

<h3 id="conf-ç›®å½•æ–°å»º-opensslconf-æ–‡ä»¶">conf ç›®å½•æ–°å»º openssl.conf æ–‡ä»¶</h3>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">[</span> <span class="s">ca</span> <span class="s">]</span> 
<span class="s">default_ca</span>     <span class="p">=</span> <span class="s">CA_default</span>          	<span class="c1"># The default ca section </span>

<span class="s">[</span> <span class="s">CA_default</span> <span class="s">]</span> 
<span class="s">dir</span>            <span class="p">=</span> <span class="s">./</span>                   <span class="c1"># top dir</span>
<span class="s">database</span>       <span class="p">=</span> <span class="s">./index.txt</span>          <span class="c1"># index file.  </span>
<span class="s">new_certs_dir</span>  <span class="p">=</span> <span class="s">./newcerts</span>           <span class="c1"># new certs dir </span>

<span class="s">certificate</span>    <span class="p">=</span> <span class="s">./private/ca.crt</span>         <span class="c1"># The CA cert  </span>
<span class="s">serial</span>         <span class="p">=</span> <span class="s">./serial</span>             <span class="c1"># serial no file  </span>
<span class="s">private_key</span>    <span class="p">=</span> <span class="s">./private/ca.key</span>  <span class="c1"># CA private key  </span>
<span class="s">RANDFILE</span>       <span class="p">=</span> <span class="s">./private/.rand</span>      <span class="c1"># random number file </span>

<span class="s">default_days</span>   <span class="p">=</span> <span class="mi">3650</span>                     <span class="c1"># how long to certify for  </span>
<span class="s">default_crl_days=</span> <span class="mi">30</span>                     <span class="c1"># how long before next CRL  </span>
<span class="s">default_md</span>     <span class="p">=</span> <span class="s">sha256</span>                     <span class="c1"># message digest method to use  </span>
<span class="s">unique_subject</span> <span class="p">=</span> <span class="s">no</span>                      <span class="c1"># Set to 'no' to allow creation of  </span>
                                         <span class="c1"># several ctificates with same subject. </span>
<span class="s">policy</span>         <span class="p">=</span> <span class="s">policy_match</span>              <span class="c1"># default policy </span>

<span class="s">[</span> <span class="s">policy_match</span> <span class="s">]</span> 
<span class="s">countryName</span> <span class="p">=</span> <span class="s">match</span>  
<span class="s">stateOrProvinceName</span> <span class="p">=</span> <span class="s">match</span>  
<span class="s">organizationName</span> <span class="p">=</span> <span class="s">match</span>  
<span class="s">organizationalUnitName</span> <span class="p">=</span> <span class="s">match</span>  
<span class="s">localityName</span>            <span class="p">=</span> <span class="s">optional</span>  
<span class="s">commonName</span>              <span class="p">=</span> <span class="s">supplied</span>  
<span class="s">emailAddress</span>            <span class="p">=</span> <span class="s">optional</span>  
</code></pre></div></div>

<h3 id="ç”Ÿæˆç§é’¥-key-æ–‡ä»¶">ç”Ÿæˆç§é’¥ key æ–‡ä»¶</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl genrsa <span class="nt">-out</span> private/ca.key 2048 
</code></pre></div></div>

<p>è¾“å‡º</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Generating RSA private key, 2048 bit long modulus  
.......+++
.........................+++
e is 65537 <span class="o">(</span>0x10001<span class="o">)</span>  
private ç›®å½•ä¸‹æœ‰ ca.key æ–‡ä»¶ç”Ÿæˆã€‚ 
</code></pre></div></div>

<h3 id="ç”Ÿæˆè¯ä¹¦è¯·æ±‚-csr-æ–‡ä»¶">ç”Ÿæˆè¯ä¹¦è¯·æ±‚ csr æ–‡ä»¶</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl req <span class="nt">-new</span> <span class="nt">-key</span> private/ca.key <span class="nt">-out</span> private/ca.csr  
</code></pre></div></div>

<h3 id="ç”Ÿæˆå‡­è¯-crt-æ–‡ä»¶">ç”Ÿæˆå‡­è¯ crt æ–‡ä»¶</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl x509 <span class="nt">-req</span> <span class="nt">-days</span> 365 <span class="nt">-in</span> private/ca.csr <span class="nt">-signkey</span> private/ca.key <span class="nt">-out</span> private/ca.crt  
</code></pre></div></div>

<p>private ç›®å½•ä¸‹æœ‰ ca.crt æ–‡ä»¶ç”Ÿæˆã€‚</p>

<h3 id="ä¸ºæˆ‘ä»¬çš„-key-è®¾ç½®èµ·å§‹åºåˆ—å·å¯ä»¥æ˜¯ä»»æ„å››ä¸ªå­—ç¬¦å’Œåˆ›å»º-ca-é”®åº“">ä¸ºæˆ‘ä»¬çš„ key è®¾ç½®èµ·å§‹åºåˆ—å·(å¯ä»¥æ˜¯ä»»æ„å››ä¸ªå­—ç¬¦)å’Œåˆ›å»º CA é”®åº“</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo </span>FACE <span class="o">&gt;</span> serial  
<span class="nb">touch </span>index.txt  
</code></pre></div></div>

<h3 id="ä¸º-ç”¨æˆ·è¯ä¹¦-çš„ç§»é™¤åˆ›å»ºä¸€ä¸ªè¯ä¹¦æ’¤é”€åˆ—è¡¨">ä¸º â€œç”¨æˆ·è¯ä¹¦â€ çš„ç§»é™¤åˆ›å»ºä¸€ä¸ªè¯ä¹¦æ’¤é”€åˆ—è¡¨</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl ca <span class="nt">-gencrl</span> <span class="nt">-out</span> ./private/ca.crl <span class="nt">-crldays</span> 7 <span class="nt">-config</span> <span class="s2">"./conf/openssl.conf"</span>  

</code></pre></div></div>

<p>è¾“å‡º:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Using configuration from ./conf/openssl.conf  
private ç›®å½•ä¸‹æœ‰ ca.crl æ–‡ä»¶ç”Ÿæˆã€‚ 
</code></pre></div></div>

<h2 id="æœåŠ¡å™¨è¯ä¹¦çš„ç”Ÿæˆ">æœåŠ¡å™¨è¯ä¹¦çš„ç”Ÿæˆ</h2>

<h3 id="åˆ›å»ºä¸€ä¸ª-key">åˆ›å»ºä¸€ä¸ª key</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl genrsa <span class="nt">-out</span> server/server.key 2048  
</code></pre></div></div>

<h3 id="ä¸ºæˆ‘ä»¬çš„-key-åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚-csr-æ–‡ä»¶">ä¸ºæˆ‘ä»¬çš„ key åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚ csr æ–‡ä»¶</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl req <span class="nt">-new</span> <span class="nt">-key</span> server/server.key <span class="nt">-out</span> server/server.csr  
</code></pre></div></div>

<h3 id="ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„-ca-key-ä¸ºåˆšæ‰çš„-key-ç­¾å">ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„ CA key ä¸ºåˆšæ‰çš„ key ç­¾å</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl ca <span class="nt">-in</span> server/server.csr <span class="nt">-cert</span> private/ca.crt <span class="nt">-keyfile</span> private/ca.key <span class="nt">-out</span> server/server.crt <span class="nt">-config</span> <span class="s2">"./conf/openssl.conf"</span>
</code></pre></div></div>

<p>è¾“å‡º</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Using configuration from ./conf/openssl.conf  
Check that the request matches the signature  
Signature ok  
The Subject<span class="s1">'s Distinguished Name is as follows  
countryName           :PRINTABLE:'</span>CN<span class="s1">'  
stateOrProvinceName   :ASN.1 12:'</span>BJ<span class="s1">'  
localityName          :ASN.1 12:'</span>BJ<span class="s1">'  
organizationName      :ASN.1 12:'</span><span class="k">****</span><span class="s1">'  
organizationalUnitName:ASN.1 12:'</span>BJ<span class="s1">'  
commonName            :ASN.1 12:'</span><span class="k">**</span><span class="s1">'  
emailAddress          :IA5STRING:'</span><span class="k">****</span><span class="s1">'  
Certificate is to be certified until Aug 17 10:15:15 2029 GMT (3650 days) 
Sign the certificate? [y/n]:y


1 out of 1 certificate requests certified, commit? [y/n]y  
Write out database with 1 new entries  
Data Base Updated  
</span></code></pre></div></div>

<p>æ³¨ï¼šç­¾åä¿¡æ¯æ¯æ¬¡å¿…é¡»è¾“å…¥ä¸€è‡´</p>

<h2 id="å®¢æˆ·ç«¯è¯ä¹¦çš„ç”Ÿæˆ">å®¢æˆ·ç«¯è¯ä¹¦çš„ç”Ÿæˆ</h2>

<h3 id="åˆ›å»ºå­˜æ”¾-key-çš„ç›®å½•-users">åˆ›å»ºå­˜æ”¾ key çš„ç›®å½• users</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir users</span>
</code></pre></div></div>

<h3 id="ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ª-key">ä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ª key</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl genrsa <span class="nt">-des3</span> <span class="nt">-out</span> ./users/client.key 2048  
</code></pre></div></div>

<p>è¾“å‡ºï¼š</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter pass phrase <span class="k">for</span> ./users/client.key:123  
Verifying - Enter pass phrase <span class="k">for</span> ./users/client.key:123  
<span class="c">#è¦æ±‚è¾“å…¥ pass phraseï¼Œè¿™ä¸ªæ˜¯å½“å‰ key çš„å£ä»¤ï¼Œä»¥é˜²æ­¢æœ¬å¯†é’¥æ³„æ¼åè¢«äººç›—ç”¨ã€‚ä¸¤æ¬¡è¾“å…¥åŒä¸€ä¸ªå¯†ç (æ¯”å¦‚æˆ‘è¿™é‡Œè¾“å…¥     123)ï¼Œusers ç›®å½•ä¸‹æœ‰ client.key æ–‡ä»¶ç”Ÿæˆã€‚</span>
</code></pre></div></div>

<h3 id="ä¸º-key-åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚-csr-æ–‡ä»¶">ä¸º key åˆ›å»ºä¸€ä¸ªè¯ä¹¦ç­¾åè¯·æ±‚ csr æ–‡ä»¶</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl req <span class="nt">-new</span> <span class="nt">-key</span> ./users/client.key <span class="nt">-out</span> ./users/client.csr  
</code></pre></div></div>

<p>users ç›®å½•ä¸‹æœ‰ client.csr æ–‡ä»¶ç”Ÿæˆã€‚</p>

<h3 id="ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„-ca-key-ä¸ºåˆšæ‰çš„-key-ç­¾å-1">ä½¿ç”¨æˆ‘ä»¬ç§æœ‰çš„ CA key ä¸ºåˆšæ‰çš„ key ç­¾å</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl ca <span class="nt">-in</span> ./users/client.csr <span class="nt">-cert</span> ./private/ca.crt <span class="nt">-keyfile</span> ./private/ca.key <span class="nt">-out</span>    ./users/client.crt <span class="nt">-config</span> <span class="s2">"./conf/openssl.conf"</span>  
</code></pre></div></div>

<p>å°†è¯ä¹¦è½¬æ¢ä¸ºå¤§å¤šæ•°æµè§ˆå™¨éƒ½èƒ½è¯†åˆ«çš„ PKCS12 æ–‡ä»¶</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pkcs12 <span class="nt">-export</span> <span class="nt">-clcerts</span> <span class="nt">-in</span> ./users/client.crt <span class="nt">-inkey</span> ./users/client.key <span class="nt">-out</span> ./users/client.p12  
</code></pre></div></div>

<p>è¾“å‡º</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter pass phrase <span class="k">for</span> ./users/client.key:  
Enter Export Password:  
Verifying - Enter Export Password:  
</code></pre></div></div>

<p>è¾“å…¥å¯†ç åï¼Œusers ç›®å½•ä¸‹æœ‰ client.p12 æ–‡ä»¶ç”Ÿæˆã€‚</p>

<p>æœ€ç»ˆç›®å½•å¤§æ¦‚å¦‚ä¸‹</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
â”œâ”€â”€ conf
â”‚Â Â  â””â”€â”€ openssl.conf
â”œâ”€â”€ index.txt
â”œâ”€â”€ index.txt.attr
â”œâ”€â”€ index.txt.attr.old
â”œâ”€â”€ index.txt.old
â”œâ”€â”€ newcerts
â”‚Â Â  â”œâ”€â”€ FACE.pem
â”‚Â Â  â””â”€â”€ FACF.pem
â”œâ”€â”€ private
â”‚Â Â  â”œâ”€â”€ ca.crl
â”‚Â Â  â”œâ”€â”€ ca.crt
â”‚Â Â  â”œâ”€â”€ ca.csr
â”‚Â Â  â””â”€â”€ ca.key
â”œâ”€â”€ serial
â”œâ”€â”€ serial.old
â”œâ”€â”€ server
â”‚Â Â  â”œâ”€â”€ server.crt
â”‚Â Â  â”œâ”€â”€ server.csr
â”‚Â Â  â””â”€â”€ server.key
â””â”€â”€ <span class="nb">users</span>
    â”œâ”€â”€ client.crt
    â”œâ”€â”€ client.csr
    â”œâ”€â”€ client.key
    â””â”€â”€ client.p12
</code></pre></div></div>

<h1 id="nginxé…ç½®">Nginxé…ç½®</h1>

<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">443</span><span class="p">;</span> 
    <span class="kn">server_name</span> <span class="s">localhost</span><span class="p">;</span> 
    <span class="kn">ssi</span> <span class="no">on</span><span class="p">;</span> 
    <span class="kn">ssi_silent_errors</span> <span class="no">on</span><span class="p">;</span> 
    <span class="kn">ssi_types</span> <span class="nc">text/shtml</span><span class="p">;</span> 

    <span class="kn">ssl</span>                  <span class="no">on</span><span class="p">;</span>
    <span class="kn">ssl_certificate</span>      <span class="n">/usr/local/nginx/ca/server/server.crt</span><span class="p">;</span> 
    <span class="kn">ssl_certificate_key</span>  <span class="n">/usr/local/nginx/ca/server/server.key</span><span class="p">;</span> 
    <span class="c1"># è¿™é‡Œæ”¾caè¯ä¹¦ï¼Œç”¨æ¥æ ¡éªŒcaé¢å‘çš„å®¢æˆ·ç«¯è¯ä¹¦</span>
    <span class="kn">ssl_client_certificate</span> <span class="n">/usr/local/nginx/ca/private/ca.crt</span><span class="p">;</span> 

    <span class="kn">ssl_session_timeout</span>  <span class="mi">5m</span><span class="p">;</span> 
    <span class="kn">ssl_verify_client</span> <span class="no">on</span><span class="p">;</span>  <span class="c1"># å¼€æˆ·å®¢æˆ·ç«¯è¯ä¹¦éªŒè¯ </span>
    <span class="kn">ssl_protocols</span> <span class="s">TLSv1</span> <span class="s">TLSv1.1</span> <span class="s">TLSv1.2</span><span class="p">;</span>
    <span class="c1"># ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDH:AES:HIGH:!aNULL:!MD5:!ADH:!DH;</span>

    <span class="kn">ssl_prefer_server_ciphers</span>   <span class="no">on</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre></div></div>

<h1 id="è§£é‡Š">è§£é‡Š</h1>

<h2 id="ssl">SSL</h2>

<p><code class="language-plaintext highlighter-rouge">Secure Sockets Layer</code>,ç°åœ¨åº”è¯¥å«<code class="language-plaintext highlighter-rouge">"TLS"</code>,ä½†ç”±äºä¹ æƒ¯é—®é¢˜,æˆ‘ä»¬è¿˜æ˜¯å«<code class="language-plaintext highlighter-rouge">"SSL"</code>æ¯”è¾ƒå¤š.<code class="language-plaintext highlighter-rouge">http</code>åè®®é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸åŠ å¯†å†…å®¹çš„,è¿™æ ·å°±å¾ˆå¯èƒ½åœ¨å†…å®¹ä¼ æ’­çš„æ—¶å€™è¢«åˆ«äººç›‘å¬åˆ°,å¯¹äºå®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºåˆ,å¿…é¡»è¦åŠ å¯†,<code class="language-plaintext highlighter-rouge">https</code>å°±æ˜¯å¸¦åŠ å¯†çš„<code class="language-plaintext highlighter-rouge">http</code>åè®®,è€Œ<code class="language-plaintext highlighter-rouge">https</code>çš„åŠ å¯†æ˜¯åŸºäº<code class="language-plaintext highlighter-rouge">SSL</code>çš„,å®ƒæ‰§è¡Œçš„æ˜¯ä¸€ä¸ªæ¯”è¾ƒä¸‹å±‚çš„åŠ å¯†,ä¹Ÿå°±æ˜¯è¯´,åœ¨åŠ å¯†å‰,ä½ çš„æœåŠ¡å™¨ç¨‹åºåœ¨å¹²å˜›,åŠ å¯†åä¹Ÿä¸€æ ·åœ¨å¹²å˜›,ä¸ç”¨åŠ¨,è¿™ä¸ªåŠ å¯†å¯¹ç”¨æˆ·å’Œå¼€å‘è€…æ¥è¯´éƒ½æ˜¯é€æ˜çš„.</p>

<h2 id="x509">X.509</h2>

<p>è¿™æ˜¯ä¸€ç§è¯ä¹¦æ ‡å‡†,ä¸»è¦å®šä¹‰äº†è¯ä¹¦ä¸­åº”è¯¥åŒ…å«å“ªäº›å†…å®¹.å…¶è¯¦æƒ…å¯ä»¥å‚è€ƒ<code class="language-plaintext highlighter-rouge">RFC5280</code>,<code class="language-plaintext highlighter-rouge">SSL</code>ä½¿ç”¨çš„å°±æ˜¯è¿™ç§è¯ä¹¦æ ‡å‡†.</p>

<h2 id="pem">PEM</h2>

<p><code class="language-plaintext highlighter-rouge">Privacy Enhanced Mail</code>,æ‰“å¼€çœ‹æ–‡æœ¬æ ¼å¼,ä»¥<code class="language-plaintext highlighter-rouge">"-----BEGIN..."</code>å¼€å¤´, <code class="language-plaintext highlighter-rouge">"-----END..."</code>ç»“å°¾,å†…å®¹æ˜¯<code class="language-plaintext highlighter-rouge">BASE64</code>ç¼–ç . æŸ¥çœ‹<code class="language-plaintext highlighter-rouge">PEM</code>æ ¼å¼è¯ä¹¦çš„ä¿¡æ¯:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl x509 <span class="nt">-in</span> server.pem <span class="nt">-text</span> <span class="nt">-noout</span> 
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Apache</code>å’Œ<code class="language-plaintext highlighter-rouge">*NIX</code>æœåŠ¡å™¨åå‘äºä½¿ç”¨è¿™ç§ç¼–ç æ ¼å¼.</p>

<h2 id="der">DER</h2>

<p><code class="language-plaintext highlighter-rouge">Distinguished Encoding Rules</code>,æ‰“å¼€çœ‹æ˜¯äºŒè¿›åˆ¶æ ¼å¼,ä¸å¯è¯». æŸ¥çœ‹<code class="language-plaintext highlighter-rouge">DER</code>æ ¼å¼è¯ä¹¦çš„ä¿¡æ¯:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl x509 <span class="nt">-in</span> server.der <span class="nt">-inform</span> der <span class="nt">-text</span> <span class="nt">-noout</span> 
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">Java</code>å’Œ<code class="language-plaintext highlighter-rouge">Windows</code>æœåŠ¡å™¨åå‘äºä½¿ç”¨è¿™ç§ç¼–ç æ ¼å¼.</p>

<h2 id="crt">CRT</h2>

<p><code class="language-plaintext highlighter-rouge">CRT</code>åº”è¯¥æ˜¯<code class="language-plaintext highlighter-rouge">certificate</code>çš„ä¸‰ä¸ªå­—æ¯,å…¶å®è¿˜æ˜¯è¯ä¹¦çš„æ„æ€,å¸¸è§äº<code class="language-plaintext highlighter-rouge">*NIX</code>ç³»ç»Ÿ,æœ‰å¯èƒ½æ˜¯<code class="language-plaintext highlighter-rouge">PEM</code>ç¼–ç ,ä¹Ÿæœ‰å¯èƒ½æ˜¯<code class="language-plaintext highlighter-rouge">DER</code>ç¼–ç ,å¤§å¤šæ•°åº”è¯¥æ˜¯<code class="language-plaintext highlighter-rouge">PEM</code>ç¼–ç ,ç›¸ä¿¡ä½ å·²ç»çŸ¥é“æ€ä¹ˆè¾¨åˆ«.</p>

<h2 id="cer">CER</h2>

<p>è¿˜æ˜¯<code class="language-plaintext highlighter-rouge">certificate</code>,è¿˜æ˜¯è¯ä¹¦,å¸¸è§äº<code class="language-plaintext highlighter-rouge">Windows</code>ç³»ç»Ÿ,åŒæ ·çš„,å¯èƒ½æ˜¯<code class="language-plaintext highlighter-rouge">PEM</code>ç¼–ç ,ä¹Ÿå¯èƒ½æ˜¯<code class="language-plaintext highlighter-rouge">DER</code>ç¼–ç ,å¤§å¤šæ•°åº”è¯¥æ˜¯<code class="language-plaintext highlighter-rouge">DER</code>ç¼–ç .</p>

<h2 id="key">KEY</h2>

<p>é€šå¸¸ç”¨æ¥å­˜æ”¾ä¸€ä¸ªå…¬é’¥æˆ–è€…ç§é’¥,å¹¶é<code class="language-plaintext highlighter-rouge">X.509</code>è¯ä¹¦,ç¼–ç åŒæ ·çš„,å¯èƒ½æ˜¯<code class="language-plaintext highlighter-rouge">PEM</code>,ä¹Ÿå¯èƒ½æ˜¯<code class="language-plaintext highlighter-rouge">DER</code>. æŸ¥çœ‹<code class="language-plaintext highlighter-rouge">KEY</code>çš„åŠæ³•:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rsa <span class="nt">-in</span> server.key <span class="nt">-text</span> <span class="nt">-noout</span> 
</code></pre></div></div>

<p>å¦‚æœæ˜¯<code class="language-plaintext highlighter-rouge">DER</code>æ ¼å¼çš„è¯,åŒç†åº”è¯¥è¿™æ ·äº†:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rsa <span class="nt">-in</span> server.key <span class="nt">-text</span> <span class="nt">-noout</span> <span class="nt">-inform</span> der
</code></pre></div></div>

<h2 id="csr">CSR</h2>

<p><code class="language-plaintext highlighter-rouge">Certificate Signing Request</code>,å³è¯ä¹¦ç­¾åè¯·æ±‚,è¿™ä¸ªå¹¶ä¸æ˜¯è¯ä¹¦,è€Œæ˜¯å‘æƒå¨è¯ä¹¦é¢å‘æœºæ„è·å¾—ç­¾åè¯ä¹¦çš„ç”³è¯·,å…¶æ ¸å¿ƒå†…å®¹æ˜¯ä¸€ä¸ªå…¬é’¥(å½“ç„¶è¿˜é™„å¸¦äº†ä¸€äº›åˆ«çš„ä¿¡æ¯),åœ¨ç”Ÿæˆè¿™ä¸ªç”³è¯·çš„æ—¶å€™,åŒæ—¶ä¹Ÿä¼šç”Ÿæˆä¸€ä¸ªç§é’¥,ç§é’¥è¦è‡ªå·±ä¿ç®¡å¥½.åšè¿‡<code class="language-plaintext highlighter-rouge">iOS APP</code>çš„æœ‹å‹éƒ½åº”è¯¥çŸ¥é“æ˜¯æ€ä¹ˆå‘è‹¹æœç”³è¯·å¼€å‘è€…è¯ä¹¦çš„å§. æŸ¥çœ‹çš„åŠæ³•:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl req <span class="nt">-noout</span> <span class="nt">-text</span> <span class="nt">-in</span> server.csr 
</code></pre></div></div>

<p>å¦‚æœæ˜¯DERæ ¼å¼çš„è¯:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl req <span class="nt">-noout</span> <span class="nt">-text</span> <span class="nt">-in</span> server.csr <span class="nt">-inform</span> der
</code></pre></div></div>

<h2 id="pfxp12">PFX/P12</h2>

<p><code class="language-plaintext highlighter-rouge">predecessor of PKCS#12</code>,å¯¹<code class="language-plaintext highlighter-rouge">*nix</code>æœåŠ¡å™¨æ¥è¯´,ä¸€èˆ¬<code class="language-plaintext highlighter-rouge">CRT</code>å’Œ<code class="language-plaintext highlighter-rouge">KEY</code>æ˜¯åˆ†å¼€å­˜æ”¾åœ¨ä¸åŒæ–‡ä»¶ä¸­çš„,ä½†<code class="language-plaintext highlighter-rouge">Windows</code>çš„<code class="language-plaintext highlighter-rouge">IIS</code>åˆ™å°†å®ƒä»¬å­˜åœ¨ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">PFX</code>æ–‡ä»¶ä¸­,(å› æ­¤è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†è¯ä¹¦åŠç§é’¥)è¿™æ ·ä¼šä¸ä¼šä¸å®‰å…¨ï¼Ÿåº”è¯¥ä¸ä¼š,<code class="language-plaintext highlighter-rouge">PFX</code>é€šå¸¸ä¼šæœ‰ä¸€ä¸ªâ€æå–å¯†ç â€,ä½ æƒ³æŠŠé‡Œé¢çš„ä¸œè¥¿è¯»å–å‡ºæ¥çš„è¯,å®ƒå°±è¦æ±‚ä½ æä¾›æå–å¯†ç ,<code class="language-plaintext highlighter-rouge">PFX</code>ä½¿ç”¨çš„æ—¶<code class="language-plaintext highlighter-rouge">DER</code>ç¼–ç ,å¦‚ä½•æŠŠ<code class="language-plaintext highlighter-rouge">PFX</code>è½¬æ¢ä¸º<code class="language-plaintext highlighter-rouge">PEM</code>ç¼–ç ï¼Ÿ</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pkcs12 <span class="nt">-in</span> server.pfx <span class="nt">-out</span> server.pem <span class="nt">-nodes</span>
</code></pre></div></div>

<p>è¿™ä¸ªæ—¶å€™ä¼šæç¤ºä½ è¾“å…¥æå–ä»£ç . <code class="language-plaintext highlighter-rouge">server.pem</code>å°±æ˜¯å¯è¯»çš„æ–‡æœ¬.
ç”Ÿæˆ<code class="language-plaintext highlighter-rouge">pfx</code>çš„å‘½ä»¤ç±»ä¼¼è¿™æ ·:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl pkcs12 <span class="nt">-export</span> <span class="nt">-in</span> server.crt <span class="nt">-inkey</span> privateKey.key <span class="nt">-out</span> server.pfx <span class="nt">-certfile</span> ca.crt
</code></pre></div></div>

<p>å…¶ä¸­<code class="language-plaintext highlighter-rouge">ca.crt</code>æ˜¯<code class="language-plaintext highlighter-rouge">CA</code>(æƒå¨è¯ä¹¦é¢å‘æœºæ„)çš„æ ¹è¯ä¹¦,æœ‰çš„è¯ä¹Ÿé€šè¿‡<code class="language-plaintext highlighter-rouge">-certfile</code>å‚æ•°ä¸€èµ·å¸¦è¿›å».è¿™ä¹ˆçœ‹æ¥<code class="language-plaintext highlighter-rouge">,PFX</code>å…¶å®æ˜¯ä¸ªè¯ä¹¦å¯†é’¥åº“.</p>

<h2 id="keytool">Keytool</h2>

<p>æ˜¯ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">Java</code>æ•°æ®è¯ä¹¦çš„ç®¡ç†å·¥å…· ,<code class="language-plaintext highlighter-rouge">Keytool</code>å°†å¯†é’¥ï¼ˆ<code class="language-plaintext highlighter-rouge">key</code>ï¼‰å’Œè¯ä¹¦ï¼ˆ<code class="language-plaintext highlighter-rouge">certificates</code>ï¼‰å­˜åœ¨ä¸€ä¸ªç§°ä¸º<code class="language-plaintext highlighter-rouge">keystore</code>çš„æ–‡ä»¶ä¸­ã€‚Â </p>

<h2 id="keystore">KeyStore</h2>

<p>æœåŠ¡å™¨çš„å¯†é’¥å­˜å‚¨åº“ï¼Œå­˜æœåŠ¡å™¨çš„å…¬é’¥ç§é’¥è¯ä¹¦ã€‚ç”¨äºæœåŠ¡å™¨è®¤è¯æœåŠ¡ç«¯ã€‚åŒ…å«ä¸¤ç§æ•°æ®ï¼šÂ 1.å¯†é’¥å®ä½“ï¼ˆ<code class="language-plaintext highlighter-rouge">Key entity</code>ï¼‰â€”â€”å¯†é’¥ï¼ˆ<code class="language-plaintext highlighter-rouge">secret key</code>ï¼‰åˆæˆ–è€…æ˜¯ç§é’¥å’Œé…å¯¹å…¬é’¥ï¼ˆé‡‡ç”¨éå¯¹ç§°åŠ å¯†ï¼‰Â Â  2. å¯ä¿¡ä»»çš„è¯ä¹¦å®ä½“ï¼ˆ<code class="language-plaintext highlighter-rouge">trusted certificate entries</code>ï¼‰â€”â€”åªåŒ…å«å…¬é’¥</p>

<h2 id="truststore">TrustStore</h2>

<p>æœåŠ¡å™¨çš„ä¿¡ä»»å¯†é’¥å­˜å‚¨åº“ï¼Œå­˜<code class="language-plaintext highlighter-rouge">CA</code>å…¬é’¥ã€‚ç”¨äºå®¢æˆ·ç«¯è®¤è¯æœåŠ¡å™¨ã€‚</p>

<h2 id="jks">JKS</h2>

<p>å³<code class="language-plaintext highlighter-rouge">Java Key Storage</code>,è¿™æ˜¯<code class="language-plaintext highlighter-rouge">Java</code>çš„ä¸“åˆ©,è·Ÿ<code class="language-plaintext highlighter-rouge">OpenSSL</code>å…³ç³»ä¸å¤§,åˆ©ç”¨<code class="language-plaintext highlighter-rouge">Java</code>çš„ä¸€ä¸ªå«â€<code class="language-plaintext highlighter-rouge">keytool</code>â€œçš„å·¥å…·,å¯ä»¥å°†<code class="language-plaintext highlighter-rouge">PFX</code>è½¬ä¸º<code class="language-plaintext highlighter-rouge">JK</code>S,å½“ç„¶äº†,<code class="language-plaintext highlighter-rouge">keytoo</code>lä¹Ÿèƒ½ç›´æ¥ç”Ÿæˆ<code class="language-plaintext highlighter-rouge">JKS</code>.</p>

<h2 id="è¯ä¹¦ç¼–ç çš„è½¬æ¢">è¯ä¹¦ç¼–ç çš„è½¬æ¢</h2>

<p>PEMè½¬ä¸ºDER</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl x509 <span class="nt">-in</span> server.crt <span class="nt">-outform</span> der <span class="nt">-out</span> server.der
</code></pre></div></div>

<p>DERè½¬ä¸ºPEM</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl x509 <span class="nt">-in</span> server.crt <span class="nt">-inform</span> der <span class="nt">-outform</span> pem <span class="nt">-out</span> server.pem
</code></pre></div></div>

<p>(æç¤º:è¦è½¬æ¢<code class="language-plaintext highlighter-rouge">KEY</code>æ–‡ä»¶ä¹Ÿç±»ä¼¼,åªä¸è¿‡æŠŠ<code class="language-plaintext highlighter-rouge">x509</code>æ¢æˆ<code class="language-plaintext highlighter-rouge">rsa</code>,è¦è½¬<code class="language-plaintext highlighter-rouge">CSR</code>çš„è¯,æŠŠ<code class="language-plaintext highlighter-rouge">x509</code>æ¢æˆ<code class="language-plaintext highlighter-rouge">req</code>â€¦)</p>

<h2 id="è¯ä¹¦æ ¼å¼ä»‹ç»">è¯ä¹¦æ ¼å¼ä»‹ç»</h2>

<p>PKCS å…¨ç§°æ˜¯ Public-Key Cryptography Standards ï¼Œæ˜¯ç”± RSA å®éªŒå®¤ä¸å…¶å®ƒå®‰å…¨ç³»ç»Ÿå¼€å‘å•†ä¸ºä¿ƒè¿›å…¬é’¥å¯†ç çš„å‘å±•è€Œåˆ¶è®¢çš„ä¸€ç³»åˆ—æ ‡å‡†ï¼ŒPKCS ç›®å‰å…±å‘å¸ƒè¿‡ 15 ä¸ªæ ‡å‡†ã€‚ å¸¸ç”¨çš„æœ‰ï¼š</p>

<ol>
  <li>PKCS#7 Cryptographic Message Syntax Standard</li>
  <li>PKCS#10 Certification Request Standard</li>
  <li>PKCS#12 Personal Information Exchange Syntax Standard</li>
</ol>

<p>X.509æ˜¯å¸¸è§é€šç”¨çš„è¯ä¹¦æ ¼å¼ã€‚æ‰€æœ‰çš„è¯ä¹¦éƒ½ç¬¦åˆä¸ºPublic Key Infrastructure (PKI) åˆ¶å®šçš„ ITU-T X509 å›½é™…æ ‡å‡†ã€‚</p>

<ol>
  <li><strong>PKCS#7</strong>å¸¸ç”¨çš„åç¼€æ˜¯ï¼š .P7B .P7C .SPC</li>
  <li><strong>PKCS#12</strong>å¸¸ç”¨çš„åç¼€æœ‰ï¼š .P12 .PFX</li>
  <li><strong>X.509 DER</strong>ç¼–ç (ASCII)çš„åç¼€æ˜¯ï¼š .DER .CER .CRT</li>
  <li><strong>X.509 PAM</strong>ç¼–ç (Base64)çš„åç¼€æ˜¯ï¼š .PEM .CER .CRT</li>
  <li><strong>.cer/.crt</strong>æ˜¯ç”¨äºå­˜æ”¾è¯ä¹¦ï¼Œå®ƒæ˜¯2è¿›åˆ¶å½¢å¼å­˜æ”¾çš„ï¼Œä¸å«ç§é’¥ã€‚</li>
  <li><strong>.pemè·Ÿcrt/cer</strong>çš„åŒºåˆ«æ˜¯å®ƒä»¥Asciiæ¥è¡¨ç¤ºã€‚</li>
  <li><strong>pfx/p12</strong>ç”¨äºå­˜æ”¾ä¸ªäººè¯ä¹¦/ç§é’¥ï¼Œä»–é€šå¸¸åŒ…å«ä¿æŠ¤å¯†ç ï¼Œ2è¿›åˆ¶æ–¹å¼</li>
  <li><strong>p10</strong>æ˜¯è¯ä¹¦è¯·æ±‚</li>
  <li><strong>p7r</strong>æ˜¯CAå¯¹è¯ä¹¦è¯·æ±‚çš„å›å¤ï¼Œåªç”¨äºå¯¼å…¥</li>
  <li><strong>p7b</strong>ä»¥æ ‘çŠ¶å±•ç¤ºè¯ä¹¦é“¾(certificate chain)ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒå•ä¸ªè¯ä¹¦ï¼Œä¸å«ç§é’¥ã€‚</li>
</ol>

<h1 id="å‚è€ƒ">å‚è€ƒ</h1>

<p><a href="https://blog.csdn.net/andy_zhang2007/article/details/78805578">https://blog.csdn.net/andy_zhang2007/article/details/78805578</a></p>

<p><a href="https://www.cnblogs.com/yjmyzz/p/openssl-tutorial.html">https://www.cnblogs.com/yjmyzz/p/openssl-tutorial.html</a></p>

<p><a href="https://www.chinassl.net/ssltools/convert-ssl.html">https://www.chinassl.net/ssltools/convert-ssl.html</a></p>

:ET